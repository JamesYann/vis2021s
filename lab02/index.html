<!DOCTYPE html>
<!-- saved from url=(0049)file:///C:/Users/LAB1223/Desktop/lab02/index.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<script src="./index_files/d3.v4.js.下載"></script>
        <script src="./index_files/dataLoader.js.下載"></script>
        <script src="./index_files/getNode.js.下載"></script>
		
		<style>
      		@import url('https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@900&display=swap');

		    div, ul {
		      border: solid black 1px;
		      margin: 5px;
		      padding: 10px;
		      background-color: rgba(255, 255, 128, 0.1);
		    }

		    div:hover, ul:hover {
		      background-color: rgba(255, 128, 128, 0.1);
		    }

			html, body {
				height: 100%;
				width: 100%;
				padding: 0;
				margin: 0;
				padding: 10px;
		        background-color: rgba(255, 255, 0, 0.02);
			}

			svg {
		        font-family: 'Noto Serif JP', serif;
			}

			#dropfile {
				height: 5%;
				width: 100%;
				border-style: dotted;;
				display: block;
				text-align: center;
			    animation-name: oxxo;
			    animation-duration: 2s;
			    animation-iteration-count: infinite;
			    padding: 10px;
		        background-color: rgba(255, 255, 0, 0.1);
		        font-family: 'Noto Serif JP', serif;
		        margin-bottom: 10px;
			}
			#dropfile:hover {
			    background-color: rgba(128, 255, 255, 0.1);
			}
			@keyframes oxxo{
			    from {
			        border-style: dotted;;
			        border-color: blue;
			        color: blue;
			    }
			    to {
			        border-style: solid;
			        border-color: red;
			        color: crimson;
			    }
			}
			
			#treemap {
				height: 95%;
				width: 100%;
			}
		</style>
	</head>
	<body>
		<div>
			Lab 02 treemap
		</div>
		<ul>
			<li>遠距教學授課防疫演練: 2021.03.18 (四) </li>
			<li>上台報告: 2021.04.01 (四) </li>
			<li><a href="https://www.d3-graph-gallery.com/graph/treemap_custom.html">Treemap customization in d3.js</a></li>
			<li><a href="http://blog.infographics.tw/2015/10/d3js-tutorial-treemap-and-budget/">D3.js 實戰 － 利用 Treemap Layout 將政府預算視覺化</a></li>
		</ul>

		<div id="dropfile" for="csvfile">
			CSV 資料扔過來! Drop your CSV here.
		</div>
		<div>
			<select id="ObjectKeys"><option value="觀光遊憩區別">觀光遊憩區別</option><option value="門票收入">門票收入</option><option value="遊客人次">遊客人次</option><option value="上年同月份遊客人次">上年同月份遊客人次</option><option value="增減數">增減數</option><option value="成長率">成長率</option><option value="備註">備註</option></select>
		</div>
		<div id="treemap"><svg width="961" height="862"><g><rect x="0" y="70" width="185.9536542045365" height="212.4707715166644" style="stroke: red; fill: rgb(177, 157, 76); opacity: 1;"></rect><rect x="190.9536542045365" y="70" width="75.95249983794119" height="105.38392631288497" style="stroke: red; fill: rgb(177, 157, 76); opacity: 0.509489;"></rect><rect x="271.9061540424777" y="70" width="77.43143905850599" height="105.38392631288497" style="stroke: red; fill: rgb(177, 157, 76); opacity: 0.511946;"></rect><rect x="190.9536542045365" y="180.38392631288497" width="158.38393889644723" height="48.044953816939284" style="stroke: red; fill: rgb(177, 157, 76); opacity: 0.505438;"></rect><rect x="190.9536542045365" y="233.42888012982425" width="158.38393889644723" height="49.04189138684015" style="stroke: red; fill: rgb(177, 157, 76); opacity: 0.50789;"></rect><rect x="351.8375931009837" y="177.88392631288497" width="0" height="0" style="stroke: red; fill: rgb(177, 157, 76);"></rect><rect x="0" y="322.4707715166644" width="162.39762808690114" height="181.19326437859854" style="stroke: red; fill: rgb(189, 179, 18); opacity: 0.855023;"></rect><rect x="167.39762808690114" y="322.4707715166644" width="135.59730824032624" height="57.40971526158381" style="stroke: red; fill: rgb(189, 179, 18); opacity: 0.510138;"></rect><rect x="167.39762808690114" y="384.8804867782482" width="135.59730824032624" height="58.49306924348116" style="stroke: red; fill: rgb(189, 179, 18); opacity: 0.512484;"></rect><rect x="167.39762808690114" y="448.37355602172937" width="135.59730824032624" height="55.29047987353357" style="stroke: red; fill: rgb(189, 179, 18); opacity: 0.505549;"></rect><rect x="307.9949363272274" y="322.4707715166644" width="41.34265677375629" height="181.19326437859866" style="stroke: red; fill: rgb(189, 179, 18); opacity: 0.50789;"></rect><rect x="305.4949363272274" y="506.16403589526305" width="0" height="0" style="stroke: red; fill: rgb(189, 179, 18);"></rect><rect x="0" y="543.6640358952629" width="136.95779959505396" height="49.84911253827204" style="stroke: red; fill: rgb(86, 106, 194); opacity: 0.507895;"></rect><rect x="0" y="598.513148433535" width="136.95779959505396" height="50.715852728590335" style="stroke: red; fill: rgb(86, 106, 194); opacity: 0.509995;"></rect><rect x="141.95779959505396" y="543.6640358952629" width="136.95779959505396" height="50.81660904027933" style="stroke: red; fill: rgb(86, 106, 194); opacity: 0.510239;"></rect><rect x="141.95779959505396" y="599.4806449355423" width="136.95779959505396" height="49.74835622658304" style="stroke: red; fill: rgb(86, 106, 194); opacity: 0.507651;"></rect><rect x="283.9155991901079" y="543.6640358952629" width="65.42199391087576" height="105.56496526686249" style="stroke: red; fill: rgb(86, 106, 194); opacity: 0.507894;"></rect><rect x="281.4155991901079" y="651.7290011621254" width="0" height="0" style="stroke: red; fill: rgb(86, 106, 194);"></rect><rect x="0" y="689.2290011621253" width="119.67063340866964" height="152.77099883787457" style="stroke: red; fill: rgb(216, 163, 72); opacity: 0.686564;"></rect><rect x="124.67063340866964" y="689.2290011621253" width="118.60610173938251" height="73.69807073213144" style="stroke: red; fill: rgb(216, 163, 72); opacity: 0.529085;"></rect><rect x="124.67063340866964" y="767.9270718942568" width="118.60610173938251" height="74.07292810574313" style="stroke: red; fill: rgb(216, 163, 72); opacity: 0.529819;"></rect><rect x="248.27673514805215" y="689.2290011621253" width="47.883642816829166" height="152.77099883787457" style="stroke: red; fill: rgb(216, 163, 72); opacity: 0.507161;"></rect><rect x="301.1603779648813" y="689.2290011621253" width="48.17721513610235" height="152.77099883787457" style="stroke: red; fill: rgb(216, 163, 72); opacity: 0.507895;"></rect><rect x="248.27673514805215" y="844.4999999999999" width="101.06085795293151" height="0" style="stroke: red; fill: rgb(216, 163, 72);"></rect><rect x="369.33759310098367" y="70" width="76.13693865389376" height="101.88563372228018" style="stroke: red; fill: rgb(68, 207, 235); opacity: 0.507895;"></rect><rect x="450.47453175487743" y="70" width="83.88093093269873" height="101.88563372228018" style="stroke: red; fill: rgb(68, 207, 235); opacity: 0.520579;"></rect><rect x="369.33759310098367" y="176.88563372228018" width="110.09232877354754" height="76.70865946548278" style="stroke: red; fill: rgb(68, 207, 235); opacity: 0.519107;"></rect><rect x="369.33759310098367" y="258.59429318776296" width="110.09232877354754" height="71.18603194032386" style="stroke: red; fill: rgb(68, 207, 235); opacity: 0.509367;"></rect><rect x="484.4299218745312" y="176.88563372228018" width="49.92554081304496" height="152.89469140580664" style="stroke: red; fill: rgb(68, 207, 235); opacity: 0.507896;"></rect><rect x="481.9299218745312" y="332.2803251280868" width="0" height="0" style="stroke: red; fill: rgb(68, 207, 235);"></rect><rect x="554.3554626875762" y="70" width="76.11934742050744" height="101.92242547108754" style="stroke: red; fill: rgb(197, 65, 128); opacity: 0.507895;"></rect><rect x="635.4748101080836" y="70" width="84.16593518567447" height="101.92242547108754" style="stroke: red; fill: rgb(197, 65, 128); opacity: 0.521078;"></rect><rect x="554.3554626875762" y="176.92242547108754" width="110.33990682660954" height="76.72989022028628" style="stroke: red; fill: rgb(197, 65, 128); opacity: 0.519436;"></rect><rect x="554.3554626875762" y="258.6523156913738" width="110.33990682660954" height="71.128009436713" style="stroke: red; fill: rgb(197, 65, 128); opacity: 0.509536;"></rect><rect x="669.6953695141857" y="176.92242547108754" width="49.94537577957237" height="152.85789965699928" style="stroke: red; fill: rgb(197, 65, 128); opacity: 0.507896;"></rect><rect x="669.6953695141857" y="332.2803251280868" width="49.94537577957237" height="0" style="stroke: red; fill: rgb(197, 65, 128);"></rect><rect x="739.6407452937581" y="70" width="75.73571118689392" height="102.7308703972214" style="stroke: red; fill: rgb(14, 203, 126); opacity: 0.507895;"></rect><rect x="820.376456480652" y="70" width="90.623543519348" height="102.7308703972214" style="stroke: red; fill: rgb(14, 203, 126); opacity: 0.532401;"></rect><rect x="739.6407452937581" y="177.7308703972214" width="115.97677158235126" height="78.89374084297714" style="stroke: red; fill: rgb(14, 203, 126); opacity: 0.530073;"></rect><rect x="739.6407452937581" y="261.62461124019853" width="115.97677158235126" height="68.15571388788828" style="stroke: red; fill: rgb(14, 203, 126); opacity: 0.510224;"></rect><rect x="860.6175168761093" y="177.7308703972214" width="50.382483123890665" height="152.04945473086542" style="stroke: red; fill: rgb(14, 203, 126); opacity: 0.507896;"></rect><rect x="858.1175168761093" y="332.2803251280868" width="0" height="0" style="stroke: red; fill: rgb(14, 203, 126);"></rect><rect x="369.33759310098367" y="369.7803251280868" width="121.1029183436329" height="59.06181076930619" style="stroke: red; fill: rgb(254, 204, 146); opacity: 0.507895;"></rect><rect x="369.33759310098367" y="433.842135897393" width="121.1029183436329" height="64.4629040454609" style="stroke: red; fill: rgb(254, 204, 146); opacity: 0.5191;"></rect><rect x="495.44051144461656" y="369.7803251280868" width="121.1029183436329" height="66.15703965179569" style="stroke: red; fill: rgb(254, 204, 146); opacity: 0.522614;"></rect><rect x="495.44051144461656" y="440.9373647798825" width="121.1029183436329" height="57.36767516297141" style="stroke: red; fill: rgb(254, 204, 146); opacity: 0.504381;"></rect><rect x="621.5434297882495" y="369.7803251280868" width="55.5000535545779" height="128.5247148147671" style="stroke: red; fill: rgb(254, 204, 146); opacity: 0.507893;"></rect><rect x="621.5434297882495" y="500.8050399428539" width="55.5000535545779" height="0" style="stroke: red; fill: rgb(254, 204, 146);"></rect><rect x="369.33759310098367" y="538.3050399428539" width="122.91959372544034" height="59.14620217518552" style="stroke: red; fill: rgb(128, 178, 121); opacity: 0.507895;"></rect><rect x="369.33759310098367" y="602.4512421180394" width="122.91959372544034" height="75.14646055432411" style="stroke: red; fill: rgb(128, 178, 121); opacity: 0.541044;"></rect><rect x="497.257186826424" y="538.3050399428539" width="122.91959372544034" height="78.95731306036669" style="stroke: red; fill: rgb(128, 178, 121); opacity: 0.548939;"></rect><rect x="497.257186826424" y="622.2623530032206" width="122.91959372544034" height="55.33534966914294" style="stroke: red; fill: rgb(128, 178, 121); opacity: 0.5;"></rect><rect x="625.1767805518643" y="538.3050399428539" width="51.86670279096302" height="139.29266272950963" style="stroke: red; fill: rgb(128, 178, 121); opacity: 0.507893;"></rect><rect x="622.6767805518643" y="680.0977026723635" width="0" height="0" style="stroke: red; fill: rgb(128, 178, 121);"></rect><rect x="369.33759310098367" y="717.5977026723635" width="120.34366202894097" height="59.026242499241675" style="stroke: red; fill: rgb(181, 251, 153); opacity: 0.507895;"></rect><rect x="369.33759310098367" y="781.6239451716052" width="120.34366202894097" height="60.376054828394786" style="stroke: red; fill: rgb(181, 251, 153); opacity: 0.510697;"></rect><rect x="494.68125512992464" y="717.5977026723635" width="120.34366202894097" height="60.23654312961662" style="stroke: red; fill: rgb(181, 251, 153); opacity: 0.510407;"></rect><rect x="494.68125512992464" y="782.8342458019802" width="120.34366202894097" height="59.16575419801984" style="stroke: red; fill: rgb(181, 251, 153); opacity: 0.508185;"></rect><rect x="620.0249171588656" y="717.5977026723635" width="57.01856618396175" height="124.40229732763646" style="stroke: red; fill: rgb(181, 251, 153); opacity: 0.507896;"></rect><rect x="617.5249171588656" y="844.5" width="0" height="0" style="stroke: red; fill: rgb(181, 251, 153);"></rect><rect x="697.0434833428274" y="369.7803251280868" width="129.25315922826098" height="58.293939585700286" style="stroke: red; fill: rgb(177, 71, 16); opacity: 0.507895;"></rect><rect x="697.0434833428274" y="433.0742647137871" width="129.25315922826098" height="61.47211147900964" style="stroke: red; fill: rgb(177, 71, 16); opacity: 0.514568;"></rect><rect x="697.0434833428274" y="499.54637619279674" width="129.25315922826098" height="63.17377835371883" style="stroke: red; fill: rgb(177, 71, 16); opacity: 0.518141;"></rect><rect x="831.2966425710883" y="369.7803251280868" width="79.70335742891166" height="92.62254350353203" style="stroke: red; fill: rgb(177, 71, 16); opacity: 0.504322;"></rect><rect x="831.2966425710883" y="467.40286863161884" width="79.70335742891166" height="95.31728591489673" style="stroke: red; fill: rgb(177, 71, 16); opacity: 0.507892;"></rect><rect x="831.2966425710883" y="565.2201545465156" width="79.70335742891166" height="0" style="stroke: red; fill: rgb(177, 71, 16);"></rect><rect x="697.0434833428274" y="602.7201545465156" width="44.6360544648403" height="159.040975248564" style="stroke: red; fill: rgb(122, 107, 135); opacity: 0.507895;"></rect><rect x="746.6795378076677" y="602.7201545465156" width="46.84028438575251" height="159.040975248564" style="stroke: red; fill: rgb(122, 107, 135); opacity: 0.513797;"></rect><rect x="697.0434833428274" y="766.7611297950796" width="96.47633885059281" height="75.23887020492043" style="stroke: red; fill: rgb(122, 107, 135); opacity: 0.507895;"></rect><rect x="796.0198221934202" y="764.2611297950796" width="0" height="0" style="stroke: red; fill: rgb(122, 107, 135);"></rect><rect x="796.0198221934202" y="764.2611297950796" width="0" height="0" style="stroke: red; fill: rgb(122, 107, 135);"></rect><rect x="796.0198221934202" y="764.2611297950796" width="0" height="0" style="stroke: red; fill: rgb(122, 107, 135);"></rect><rect x="813.5198221934202" y="602.7201545465156" width="44.491893080579985" height="159.7265964759058" style="stroke: red; fill: rgb(63, 195, 120); opacity: 0.507895;"></rect><rect x="863.0117152740002" y="602.7201545465156" width="47.98828472599985" height="159.7265964759058" style="stroke: red; fill: rgb(63, 195, 120); opacity: 0.517284;"></rect><rect x="813.5198221934202" y="767.4467510224214" width="97.48017780657983" height="74.55324897757862" style="stroke: red; fill: rgb(63, 195, 120); opacity: 0.507895;"></rect><rect x="913.5" y="764.9467510224214" width="0" height="0" style="stroke: red; fill: rgb(63, 195, 120);"></rect><rect x="913.5" y="764.9467510224214" width="0" height="0" style="stroke: red; fill: rgb(63, 195, 120);"></rect><rect x="913.5" y="764.9467510224214" width="0" height="0" style="stroke: red; fill: rgb(63, 195, 120);"></rect><text x="1" y="90" font-size="1rem" fill="white">門票收入</text><text x="191.9536542045365" y="90" font-size="1rem" fill="white">遊客人次</text><text x="272.9061540424777" y="90" font-size="1rem" fill="white">上年同月份遊客人次</text><text x="191.9536542045365" y="200.38392631288497" font-size="1rem" fill="white">增減數</text><text x="191.9536542045365" y="253.42888012982425" font-size="1rem" fill="white">成長率</text><text x="352.8375931009837" y="197.88392631288497" font-size="1rem" fill="white"></text><text x="1" y="342.4707715166644" font-size="1rem" fill="white">門票收入</text><text x="168.39762808690114" y="342.4707715166644" font-size="1rem" fill="white">遊客人次</text><text x="168.39762808690114" y="404.8804867782482" font-size="1rem" fill="white">上年同月份遊客人次</text><text x="168.39762808690114" y="468.37355602172937" font-size="1rem" fill="white">增減數</text><text x="308.9949363272274" y="342.4707715166644" font-size="1rem" fill="white">成長率</text><text x="306.4949363272274" y="526.164035895263" font-size="1rem" fill="white"></text><text x="1" y="563.6640358952629" font-size="1rem" fill="white">門票收入</text><text x="1" y="618.513148433535" font-size="1rem" fill="white">遊客人次</text><text x="142.95779959505396" y="563.6640358952629" font-size="1rem" fill="white">上年同月份遊客人次</text><text x="142.95779959505396" y="619.4806449355423" font-size="1rem" fill="white">增減數</text><text x="284.9155991901079" y="563.6640358952629" font-size="1rem" fill="white">成長率</text><text x="282.4155991901079" y="671.7290011621254" font-size="1rem" fill="white"></text><text x="1" y="709.2290011621253" font-size="1rem" fill="white">門票收入</text><text x="125.67063340866964" y="709.2290011621253" font-size="1rem" fill="white">遊客人次</text><text x="125.67063340866964" y="787.9270718942568" font-size="1rem" fill="white">上年同月份遊客人次</text><text x="249.27673514805215" y="709.2290011621253" font-size="1rem" fill="white">增減數</text><text x="302.1603779648813" y="709.2290011621253" font-size="1rem" fill="white">成長率</text><text x="249.27673514805215" y="864.4999999999999" font-size="1rem" fill="white"></text><text x="370.33759310098367" y="90" font-size="1rem" fill="white">門票收入</text><text x="451.47453175487743" y="90" font-size="1rem" fill="white">遊客人次</text><text x="370.33759310098367" y="196.88563372228018" font-size="1rem" fill="white">上年同月份遊客人次</text><text x="370.33759310098367" y="278.59429318776296" font-size="1rem" fill="white">增減數</text><text x="485.4299218745312" y="196.88563372228018" font-size="1rem" fill="white">成長率</text><text x="482.9299218745312" y="352.2803251280868" font-size="1rem" fill="white"></text><text x="555.3554626875762" y="90" font-size="1rem" fill="white">門票收入</text><text x="636.4748101080836" y="90" font-size="1rem" fill="white">遊客人次</text><text x="555.3554626875762" y="196.92242547108754" font-size="1rem" fill="white">上年同月份遊客人次</text><text x="555.3554626875762" y="278.6523156913738" font-size="1rem" fill="white">增減數</text><text x="670.6953695141857" y="196.92242547108754" font-size="1rem" fill="white">成長率</text><text x="670.6953695141857" y="352.2803251280868" font-size="1rem" fill="white"></text><text x="740.6407452937581" y="90" font-size="1rem" fill="white">門票收入</text><text x="821.376456480652" y="90" font-size="1rem" fill="white">遊客人次</text><text x="740.6407452937581" y="197.7308703972214" font-size="1rem" fill="white">上年同月份遊客人次</text><text x="740.6407452937581" y="281.62461124019853" font-size="1rem" fill="white">增減數</text><text x="861.6175168761093" y="197.7308703972214" font-size="1rem" fill="white">成長率</text><text x="859.1175168761093" y="352.2803251280868" font-size="1rem" fill="white"></text><text x="370.33759310098367" y="389.7803251280868" font-size="1rem" fill="white">門票收入</text><text x="370.33759310098367" y="453.842135897393" font-size="1rem" fill="white">遊客人次</text><text x="496.44051144461656" y="389.7803251280868" font-size="1rem" fill="white">上年同月份遊客人次</text><text x="496.44051144461656" y="460.9373647798825" font-size="1rem" fill="white">增減數</text><text x="622.5434297882495" y="389.7803251280868" font-size="1rem" fill="white">成長率</text><text x="622.5434297882495" y="520.8050399428539" font-size="1rem" fill="white"></text><text x="370.33759310098367" y="558.3050399428539" font-size="1rem" fill="white">門票收入</text><text x="370.33759310098367" y="622.4512421180394" font-size="1rem" fill="white">遊客人次</text><text x="498.257186826424" y="558.3050399428539" font-size="1rem" fill="white">上年同月份遊客人次</text><text x="498.257186826424" y="642.2623530032206" font-size="1rem" fill="white">增減數</text><text x="626.1767805518643" y="558.3050399428539" font-size="1rem" fill="white">成長率</text><text x="623.6767805518643" y="700.0977026723635" font-size="1rem" fill="white"></text><text x="370.33759310098367" y="737.5977026723635" font-size="1rem" fill="white">門票收入</text><text x="370.33759310098367" y="801.6239451716052" font-size="1rem" fill="white">遊客人次</text><text x="495.68125512992464" y="737.5977026723635" font-size="1rem" fill="white">上年同月份遊客人次</text><text x="495.68125512992464" y="802.8342458019802" font-size="1rem" fill="white">增減數</text><text x="621.0249171588656" y="737.5977026723635" font-size="1rem" fill="white">成長率</text><text x="618.5249171588656" y="864.5" font-size="1rem" fill="white"></text><text x="698.0434833428274" y="389.7803251280868" font-size="1rem" fill="white">門票收入</text><text x="698.0434833428274" y="453.0742647137871" font-size="1rem" fill="white">遊客人次</text><text x="698.0434833428274" y="519.5463761927967" font-size="1rem" fill="white">上年同月份遊客人次</text><text x="832.2966425710883" y="389.7803251280868" font-size="1rem" fill="white">增減數</text><text x="832.2966425710883" y="487.40286863161884" font-size="1rem" fill="white">成長率</text><text x="832.2966425710883" y="585.2201545465156" font-size="1rem" fill="white"></text><text x="698.0434833428274" y="622.7201545465156" font-size="1rem" fill="white">門票收入</text><text x="747.6795378076677" y="622.7201545465156" font-size="1rem" fill="white">遊客人次</text><text x="698.0434833428274" y="786.7611297950796" font-size="1rem" fill="white">上年同月份遊客人次</text><text x="797.0198221934202" y="784.2611297950796" font-size="1rem" fill="white"></text><text x="797.0198221934202" y="784.2611297950796" font-size="1rem" fill="white"></text><text x="797.0198221934202" y="784.2611297950796" font-size="1rem" fill="white"></text><text x="814.5198221934202" y="622.7201545465156" font-size="1rem" fill="white">門票收入</text><text x="864.0117152740002" y="622.7201545465156" font-size="1rem" fill="white">遊客人次</text><text x="814.5198221934202" y="787.4467510224214" font-size="1rem" fill="white">上年同月份遊客人次</text><text x="914.5" y="784.9467510224214" font-size="1rem" fill="white"></text><text x="914.5" y="784.9467510224214" font-size="1rem" fill="white"></text><text x="914.5" y="784.9467510224214" font-size="1rem" fill="white"></text><text x="1" y="105" font-size=".9rem" fill="white">5337819</text><text x="191.9536542045365" y="105" font-size=".9rem" fill="white">17290</text><text x="272.9061540424777" y="105" font-size=".9rem" fill="white">43941</text><text x="191.9536542045365" y="215.38392631288497" font-size=".9rem" fill="white">-26651</text><text x="191.9536542045365" y="268.4288801298243" font-size=".9rem" fill="white">-60</text><text x="352.8375931009837" y="212.88392631288497" font-size=".9rem" fill="white"></text><text x="1" y="357.4707715166644" font-size=".9rem" fill="white">3765267</text><text x="168.39762808690114" y="357.4707715166644" font-size=".9rem" fill="white">24330</text><text x="168.39762808690114" y="419.8804867782482" font-size=".9rem" fill="white">49775</text><text x="168.39762808690114" y="483.37355602172937" font-size=".9rem" fill="white">-25445</text><text x="308.9949363272274" y="357.4707715166644" font-size=".9rem" fill="white">-51</text><text x="306.4949363272274" y="541.164035895263" font-size=".9rem" fill="white"></text><text x="1" y="578.6640358952629" font-size=".9rem" fill="white">0</text><text x="1" y="633.513148433535" font-size=".9rem" fill="white">22779</text><text x="142.95779959505396" y="578.6640358952629" font-size=".9rem" fill="white">25427</text><text x="142.95779959505396" y="634.4806449355423" font-size=".9rem" fill="white">-2648</text><text x="284.9155991901079" y="578.6640358952629" font-size=".9rem" fill="white">-10</text><text x="282.4155991901079" y="686.7290011621254" font-size=".9rem" fill="white"></text><text x="1" y="724.2290011621253" font-size=".9rem" fill="white">1938002</text><text x="125.67063340866964" y="724.2290011621253" font-size=".9rem" fill="white">229841</text><text x="125.67063340866964" y="802.9270718942568" font-size=".9rem" fill="white">237802</text><text x="249.27673514805215" y="724.2290011621253" font-size=".9rem" fill="white">-7961</text><text x="302.1603779648813" y="724.2290011621253" font-size=".9rem" fill="white">-3</text><text x="249.27673514805215" y="879.4999999999999" font-size=".9rem" fill="white"></text><text x="370.33759310098367" y="105" font-size=".9rem" fill="white">0</text><text x="451.47453175487743" y="105" font-size=".9rem" fill="white">137582</text><text x="370.33759310098367" y="211.88563372228018" font-size=".9rem" fill="white">121616</text><text x="370.33759310098367" y="293.59429318776296" font-size=".9rem" fill="white">15966</text><text x="485.4299218745312" y="211.88563372228018" font-size=".9rem" fill="white">13</text><text x="482.9299218745312" y="367.2803251280868" font-size=".9rem" fill="white"></text><text x="555.3554626875762" y="105" font-size=".9rem" fill="white">0</text><text x="636.4748101080836" y="105" font-size=".9rem" fill="white">142989</text><text x="555.3554626875762" y="211.92242547108754" font-size=".9rem" fill="white">125186</text><text x="555.3554626875762" y="293.6523156913738" font-size=".9rem" fill="white">17803</text><text x="670.6953695141857" y="211.92242547108754" font-size=".9rem" fill="white">14</text><text x="670.6953695141857" y="367.2803251280868" font-size=".9rem" fill="white"></text><text x="740.6407452937581" y="105" font-size=".9rem" fill="white">0</text><text x="821.376456480652" y="105" font-size=".9rem" fill="white">265816</text><text x="740.6407452937581" y="212.7308703972214" font-size=".9rem" fill="white">240556</text><text x="740.6407452937581" y="296.62461124019853" font-size=".9rem" fill="white">25260</text><text x="861.6175168761093" y="212.7308703972214" font-size=".9rem" fill="white">10</text><text x="859.1175168761093" y="367.2803251280868" font-size=".9rem" fill="white"></text><text x="370.33759310098367" y="404.7803251280868" font-size=".9rem" fill="white">0</text><text x="370.33759310098367" y="468.842135897393" font-size=".9rem" fill="white">121534</text><text x="496.44051144461656" y="404.7803251280868" font-size=".9rem" fill="white">159655</text><text x="496.44051144461656" y="475.9373647798825" font-size=".9rem" fill="white">-38121</text><text x="622.5434297882495" y="404.7803251280868" font-size=".9rem" fill="white">-23</text><text x="622.5434297882495" y="535.8050399428539" font-size=".9rem" fill="white"></text><text x="370.33759310098367" y="573.3050399428539" font-size=".9rem" fill="white">0</text><text x="370.33759310098367" y="637.4512421180394" font-size=".9rem" fill="white">359560</text><text x="498.257186826424" y="573.3050399428539" font-size=".9rem" fill="white">445198</text><text x="498.257186826424" y="657.2623530032206" font-size=".9rem" fill="white">-85638</text><text x="626.1767805518643" y="573.3050399428539" font-size=".9rem" fill="white">-19</text><text x="623.6767805518643" y="715.0977026723635" font-size=".9rem" fill="white"></text><text x="370.33759310098367" y="752.5977026723635" font-size=".9rem" fill="white">0</text><text x="370.33759310098367" y="816.6239451716052" font-size=".9rem" fill="white">30390</text><text x="495.68125512992464" y="752.5977026723635" font-size=".9rem" fill="white">27249</text><text x="495.68125512992464" y="817.8342458019802" font-size=".9rem" fill="white">3141</text><text x="621.0249171588656" y="752.5977026723635" font-size=".9rem" fill="white">11</text><text x="618.5249171588656" y="879.5" font-size=".9rem" fill="white"></text><text x="698.0434833428274" y="404.7803251280868" font-size=".9rem" fill="white">0</text><text x="698.0434833428274" y="468.0742647137871" font-size=".9rem" fill="white">72382</text><text x="698.0434833428274" y="534.5463761927967" font-size=".9rem" fill="white">111137</text><text x="832.2966425710883" y="404.7803251280868" font-size=".9rem" fill="white">-38755</text><text x="832.2966425710883" y="502.40286863161884" font-size=".9rem" fill="white">-34</text><text x="832.2966425710883" y="600.2201545465156" font-size=".9rem" fill="white"></text><text x="698.0434833428274" y="637.7201545465156" font-size=".9rem" fill="white">0</text><text x="747.6795378076677" y="637.7201545465156" font-size=".9rem" fill="white">64014</text><text x="698.0434833428274" y="801.7611297950796" font-size=".9rem" fill="white">0</text><text x="797.0198221934202" y="799.2611297950796" font-size=".9rem" fill="white"></text><text x="797.0198221934202" y="799.2611297950796" font-size=".9rem" fill="white"></text><text x="797.0198221934202" y="799.2611297950796" font-size=".9rem" fill="white"></text><text x="814.5198221934202" y="637.7201545465156" font-size=".9rem" fill="white">0</text><text x="864.0117152740002" y="637.7201545465156" font-size=".9rem" fill="white">101836</text><text x="814.5198221934202" y="802.4467510224214" font-size=".9rem" fill="white">0</text><text x="914.5" y="799.9467510224214" font-size=".9rem" fill="white"></text><text x="914.5" y="799.9467510224214" font-size=".9rem" fill="white"></text><text x="914.5" y="799.9467510224214" font-size=".9rem" fill="white"></text><text x="1" y="56" font-size="1.1rem" fill="black">小人國企業股份有限公司</text><text x="1" y="308.4707715166644" font-size="1.1rem" fill="black">埔心牧場</text><text x="1" y="529.6640358952629" font-size="1.1rem" fill="black">小烏來風景特定區</text><text x="1" y="675.2290011621253" font-size="1.1rem" fill="black">石門水庫</text><text x="370.33759310098367" y="56" font-size="1.1rem" fill="black">慈湖</text><text x="555.3554626875762" y="56" font-size="1.1rem" fill="black">角板山遊憩區</text><text x="740.6407452937581" y="56" font-size="1.1rem" fill="black">虎頭山風景特定區</text><text x="370.33759310098367" y="355.7803251280868" font-size="1.1rem" fill="black">竹圍漁港</text><text x="370.33759310098367" y="524.3050399428539" font-size="1.1rem" fill="black">大溪老城區</text><text x="370.33759310098367" y="703.5977026723635" font-size="1.1rem" fill="black">桃園市客家文化館</text><text x="698.0434833428274" y="355.7803251280868" font-size="1.1rem" fill="black">永安漁港</text><text x="698.0434833428274" y="588.7201545465156" font-size="1.1rem" fill="black">新屋綠色走廊</text><text x="814.5198221934202" y="588.7201545465156" font-size="1.1rem" fill="black">觀音蓮花園休閒農業區</text></g></svg></div>


		<script>
			var Base64 = { _keyStr: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=", encode: function (r) { var t, e, o, a, h, c, n = "", d = 0; for (r = Base64._utf8_encode(r); d < r.length;)o = (c = r.charCodeAt(d++)) >> 2, a = (3 & c) << 4 | (t = r.charCodeAt(d++)) >> 4, h = (15 & t) << 2 | (e = r.charCodeAt(d++)) >> 6, c = 63 & e, isNaN(t) ? h = c = 64 : isNaN(e) && (c = 64), n = n + this._keyStr.charAt(o) + this._keyStr.charAt(a) + this._keyStr.charAt(h) + this._keyStr.charAt(c); return n }, decode: function (r) { var t, e, o, a, h, c = "", n = 0; for (r = r.replace(/[^A-Za-z0-9\+\/\=]/g, ""); n < r.length;)t = this._keyStr.indexOf(r.charAt(n++)) << 2 | (o = this._keyStr.indexOf(r.charAt(n++))) >> 4, e = (15 & o) << 4 | (a = this._keyStr.indexOf(r.charAt(n++))) >> 2, o = (3 & a) << 6 | (h = this._keyStr.indexOf(r.charAt(n++))), c += String.fromCharCode(t), 64 != a && (c += String.fromCharCode(e)), 64 != h && (c += String.fromCharCode(o)); return c = Base64._utf8_decode(c) }, _utf8_encode: function (r) { r = r.replace(/\r\n/g, "\n"); for (var t = "", e = 0; e < r.length; e++) { var o = r.charCodeAt(e); o < 128 ? t += String.fromCharCode(o) : (127 < o && o < 2048 ? t += String.fromCharCode(o >> 6 | 192) : (t += String.fromCharCode(o >> 12 | 224), t += String.fromCharCode(o >> 6 & 63 | 128)), t += String.fromCharCode(63 & o | 128)) } return t }, _utf8_decode: function (r) { for (var t = "", e = 0, o = c1 = c2 = 0; e < r.length;)(o = r.charCodeAt(e)) < 128 ? (t += String.fromCharCode(o), e++) : 191 < o && o < 224 ? (c2 = r.charCodeAt(e + 1), t += String.fromCharCode((31 & o) << 6 | 63 & c2), e += 2) : (c2 = r.charCodeAt(e + 1), c3 = r.charCodeAt(e + 2), t += String.fromCharCode((15 & o) << 12 | (63 & c2) << 6 | 63 & c3), e += 3); return t } };
		</script>

		<script>
			var csvData = null
			window.addEventListener('load', function(){
                var treemapContainer = document.getElementById('treemap')
                var objectKeys = document.getElementById("ObjectKeys")

                document.getElementById("ObjectKeys").addEventListener('change', function(evt){
					if(evt.target.value == 'selectValue' ){
						return;
					}
				
                    //clear container
                    if (treemapContainer.innerHTML.length) {
                        treemapContainer.innerHTML = ''
                    }


                    dataClassifier(objectKeys.value, function(data, layers){
                        node = getNode(data, layers, treemapContainer)
                        treemapContainer.appendChild(node)
                    })
				})

				document.getElementById('dropfile').addEventListener('dragover',function(evt){
					evt.preventDefault()
				})

				document.getElementById('dropfile').addEventListener('drop', function(evt){
					evt.preventDefault()

					var files = evt.dataTransfer.files

					if (files.length) {
                        if (treemapContainer.innerHTML.length) {
                            treemapContainer.innerHTML = ''
                        }

                        if (objectKeys.innerHTML.length) {
                            objectKeys.innerHTML = ''
						}

						var csvFile = files[0]

						//讀取csv
						var fr = new FileReader()

                        fr.onload = function(){
                            dataLoader(fr.result, function(){
								dataClassifier(objectKeys.value, function(data, layers){
									node = getNode(data, layers, treemapContainer)
									treemapContainer.innerHTML = node.innerHTML
								}) 
							})			                         
                        }

						fr.readAsText(csvFile)
					}
				})
			})
		</script>

	
	
</body></html>
